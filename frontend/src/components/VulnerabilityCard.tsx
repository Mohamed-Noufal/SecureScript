import { AlertTriangle, Shield, AlertCircle } from "lucide-react";
import { Button } from "@/components/ui/button";

interface VulnerabilityCardProps {
    severity: "critical" | "high" | "medium";
    title: string;
    description: string;
    codeSnippet?: string;
    actionLabel?: string;
    onAction?: () => void;
}

const severityConfig = {
    critical: {
        icon: Shield,
        label: "Critical",
        badgeClass: "bg-critical text-critical-foreground",
        borderClass: "border-l-critical",
    },
    high: {
        icon: AlertTriangle,
        label: "High",
        badgeClass: "bg-high text-high-foreground",
        borderClass: "border-l-high",
    },
    medium: {
        icon: AlertCircle,
        label: "Medium",
        badgeClass: "bg-medium text-medium-foreground",
        borderClass: "border-l-medium",
    },
};

export function VulnerabilityCard({
    severity,
    title,
    description,
    codeSnippet,
    actionLabel = "Fix Issue",
    onAction
}: VulnerabilityCardProps) {
    const config = severityConfig[severity];
    // Fallback for safety if severity is invalid
    const Icon = config?.icon || AlertCircle;
    const safeConfig = config || severityConfig.medium;

    return (
        <div className={`bg-card rounded-lg border border-l-4 ${safeConfig.borderClass} p-4 shadow-card hover:shadow-card-hover transition-shadow`}>
            {/* Header */}
            <div className="flex items-start gap-3 mb-3">
                <span className={`inline-flex items-center gap-1.5 px-2 py-0.5 rounded text-xs font-medium ${safeConfig.badgeClass}`}>
                    <Icon className="w-3 h-3" />
                    {safeConfig.label}
                </span>
                <h3 className="font-semibold text-foreground flex-1">{title}</h3>
            </div>

            {/* Description */}
            <p className="text-sm text-muted-foreground mb-3 leading-relaxed">
                {description}
            </p>

            {/* Code snippet */}
            {codeSnippet && (
                <div className="bg-muted/50 rounded-md p-3 mb-4 font-mono text-xs overflow-x-auto">
                    <code className="text-foreground whitespace-pre">{codeSnippet}</code>
                </div>
            )}

            {/* Actions */}
            <div className="flex items-center gap-2">
                <Button variant="outline" size="sm">
                    View Details
                </Button>
                <div className="ml-auto flex items-center gap-2">
                    <Button variant="outline" size="sm">
                        Ignore
                    </Button>
                    <Button
                        size="sm"
                        className={`${actionLabel === "Fix Included in Fix All"
                            ? "bg-primary hover:bg-primary/90 text-primary-foreground" // Primary Color
                            : severity === "critical"
                                ? "bg-critical hover:bg-critical/90 text-white"
                                : severity === "high"
                                    ? "bg-high hover:bg-high/90 text-white"
                                    : "bg-medium hover:bg-medium/90 text-white"
                            }`}
                        onClick={onAction}
                    >
                        {actionLabel}
                    </Button>
                </div>
            </div>
        </div>
    );
}
